function getCurrency(t){return t.substr(t.indexOf(" ")+1)}function getURLParameter(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function getUsdValue(t){return t.currency?parseFloat(t.amount)*("SBD"==t.currency?sbd_price:steem_price):parseFloat(t.amount)*("SBD"==getCurrency(t.amount)?sbd_price:steem_price)}function toTimer(t){var e=Math.floor(t/HOURS),a=Math.floor(t%HOURS/6e4),n=Math.floor(t%6e4/1e3);return e+":"+padLeft(a,2)+":"+padLeft(n,2)}function padLeft(t,e){var a=(t+"").length;if(a>=e)return t+"";for(var n=a;n<e;n++)t="0"+t;return t}function updateTimers(){for(var t=$(".timer"),e=0;e<t.length;e++){var a=$(t[e]);if(!a.attr("time"))return;var n=parseInt(a.attr("time"));"up"==a.attr("dir")?n+=1e3:n=Math.max(n-1e3,0),a.attr("time",n),a.text(toTimer(n))}}function updateSteemVariables(t){steem.api.getRewardFund("post",function(e,a){rewardBalance=parseFloat(a.reward_balance.replace(" STEEM","")),recentClaims=a.recent_claims,steem.api.getCurrentMedianHistoryPrice(function(e,a){steemPrice=parseFloat(a.base.replace(" SBD",""))/parseFloat(a.quote.replace(" STEEM","")),steem.api.getDynamicGlobalProperties(function(e,a){votePowerReserveRate=a.vote_power_reserve_rate,totalVestingFund=parseFloat(a.total_vesting_fund_steem.replace(" STEEM","")),totalVestingShares=parseFloat(a.total_vesting_shares.replace(" VESTS",""));var n=a.total_vesting_fund_steem.replace(" STEEM",""),o=a.total_vesting_shares.replace(" VESTS","");steem_per_mvests=n/o*1e6,t&&t()})})}),setTimeout(updateSteemVariables,6e5)}function getVotingPower(t){var e=t.voting_power,a=new Date(t.last_vote_time+"Z"),n=(new Date-a)/1e3,o=Math.round(STEEMIT_100_PERCENT*n/STEEMIT_VOTE_REGENERATION_SECONDS);return Math.min(e+o,STEEMIT_100_PERCENT)}function getVoteRShares(t,e,a){if(e&&rewardBalance&&recentClaims&&steemPrice&&votePowerReserveRate){var n=Math.round(1e6*getVestingShares(e)),o=e.voting_power,r=100*t,i=new Date(e.last_vote_time+"Z"),s=(new Date-i)/1e3,l=Math.round(STEEMIT_100_PERCENT*s/STEEMIT_VOTE_REGENERATION_SECONDS),c=a||Math.min(o+l,STEEMIT_100_PERCENT),d=votePowerReserveRate*STEEMIT_VOTE_REGENERATION_SECONDS/86400,m=Math.round(c*r/STEEMIT_100_PERCENT);m=Math.round((m+d-1)/d);return Math.round(n*m/STEEMIT_100_PERCENT)}}function getVoteValue(t,e,a){if(e&&rewardBalance&&recentClaims&&steemPrice&&votePowerReserveRate){return getVoteRShares(t,e,a)*rewardBalance/recentClaims*steemPrice}}function timeTilFullPower(t){var e=getVotingPower(t);return(STEEMIT_100_PERCENT-e)*STEEMIT_VOTE_REGENERATION_SECONDS/STEEMIT_100_PERCENT}function getVestingShares(t){return parseFloat(t.vesting_shares.replace(" VESTS",""))+parseFloat(t.received_vesting_shares.replace(" VESTS",""))-parseFloat(t.delegated_vesting_shares.replace(" VESTS",""))}var STEEMIT_100_PERCENT=1e4,STEEMIT_VOTE_REGENERATION_SECONDS=432e3,HOURS=36e5,steem_price=1,sbd_price=1;Number.prototype.formatMoney=function(t,e,a){var n=this,o=(t=isNaN(t=Math.abs(t))?2:t,e=void 0==e?".":e,a=void 0==a?",":a,n<0?"-":""),r=String(parseInt(n=Math.abs(Number(n)||0).toFixed(t))),i=(i=r.length)>3?i%3:0;return o+(i?r.substr(0,i)+a:"")+r.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+a)+(t?e+Math.abs(n-r).toFixed(t).slice(2):"")},$(document).ready(function(){$(".modal.modal-center").on("show.bs.modal",function(t){$(".modal.modal-center").each(function(){0==$(this).hasClass("in")&&$(this).show();var t=$(window).height()-60,e=$(this).find(".modal-header").outerHeight()||2,a=$(this).find(".modal-footer").outerHeight()||2;$(this).find(".modal-content").css({"max-height":function(){return t}}),$(this).find(".modal-body").css({"max-height":function(){return t-(e+a)}}),$(this).find(".modal-dialog").addClass("modal-dialog-center").css({"margin-top":function(){return-$(this).outerHeight()/2},"margin-left":function(){return-$(this).outerWidth()/2}}),0==$(this).hasClass("in")&&$(this).hide()})})});var steemPrice,rewardBalance,recentClaims,currentUserAccount,votePowerReserveRate,totalVestingFund,totalVestingShares,steem_per_mvests;$(function(){function t(){$.get("https://api.coinmarketcap.com/v1/ticker/steem/",function(t){steem_price=parseFloat(t[0].price_usd),$("#steem_price").text(steem_price.formatMoney())}),$.get("https://api.coinmarketcap.com/v1/ticker/steem-dollars/",function(t){sbd_price=parseFloat(t[0].price_usd),$("#sbd_price").text(sbd_price.formatMoney())})}function e(){$.get(v+"/other_bots",function(t){t.sort(function(t,e){return e.vote_value-t.vote_value});var e=$("#other_table tbody");e.empty();for(var a=0;a<t.length;a++){var n=t[a],o=$(document.createElement("tr")),r=$('<td><a target="_blank" href="https://steemit.com/@'+n.name+'">@'+n.name+"</a></td>");o.append(r),r=$("<td>$"+n.vote_value.toFixed(2)+"</td>"),o.append(r),r=$("<td>"+(n.profile.about?n.profile.about:"")+"</td>"),o.append(r),r=$("<td>"+(n.profile.website?'<a target="_blank" href="'+n.profile.website+'">'+n.profile.website+"</a>":"")+"</td>"),o.append(r),e.append(o)}})}function a(){$.get(v+"/bid_bots",function(t){t.map(function(t){return t.name}).sort().forEach(function(t){$("#bot_list").append('<option value="'+t+'">'+t+"</option>")}),f=t,o()})}function n(){steem.api.getAccounts(["smartsteem","randowhale","minnowbooster"],function(t,e){try{var a=e[0],n=$("#smartsteem-progress div"),o=getVotingPower(a)/100;n.attr("aria-valuenow",o),n.css("width",o+"%"),n.text(o+"%"),$("#smartsteem-vote").text("$"+getVoteValue(100,a).formatMoney()),$("#ss_bot_error").css("display","none"),a=e[1];var r=JSON.parse(a.json_metadata);$("#randowhale-desc").text(r.profile.about);var i=r.config,s=$("#randowhale-status");s.text(i.sleep?"Sleeping":"Awake!"),i.sleep?(s.removeClass("label-success"),s.addClass("label-default"),$("#randowhale-submit").attr("disabled","disabled")):(s.removeClass("label-default"),s.addClass("label-success"),$("#randowhale-submit").removeAttr("disabled")),$("#randowhale-fee").text(i.fee_sbd.formatMoney()+" SBD");n=$("#randowhale-progress div"),o=getVotingPower(a)/100;n.attr("aria-valuenow",o),n.css("width",o+"%"),n.text(o+"%"),$("#randowhale-vote").text("$"+getVoteValue(100,a).formatMoney()),$("#rw_bot_error").css("display","none"),a=e[2];n=$("#minnowbooster-progress div"),o=getVotingPower(a)/100;n.attr("aria-valuenow",o),n.css("width",o+"%"),n.text(o+"%"),$("#minnowbooster-vote").text("$"+getVoteValue(100,a).formatMoney()),$("#mb_bot_error").css("display","none")}catch(t){console.log(t),$("#ss_bot_error").css("display","block")}}),$.get("https://smartsteem.com/api/general/bot_tracker",function(t){$("#smartsteem-desc").text(t.description),$("#smartsteem-profit").text(t.profit),$("#smartsteem-payment").text(t.payment),$("#smartsteem-daily").text(t.daily_limit),$("#smartsteem-weekly").text(t.weekly_limit),$("#smartsteem-features").text(t.additional_features),$("#smartsteem-howto").empty(),t.how_to.forEach(function(t){$("#smartsteem-howto").append($("<li>"+t+"</li>"))})})}function o(){$("#bots_table tbody").empty(),f.sort(function(t,e){return(100==t.power&&t.last>3*HOURS||t.last<6e4?999e7:t.next)-(100==e.power&&e.last>3*HOURS||e.last<6e4?999e7:e.next)}),f.forEach(function(t){if(!(t.vote_usd<p||b.verified&&!t.api_url||b.refund&&!t.refunds||b.steem&&!t.accepts_steem||b.funding&&!t.funding_url||b.nocomment&&(void 0==t.posts_comment||t.posts_comment))){var e=(u*t.vote_usd-m*t.total_usd)/sbd_price,a=t.accepts_steem?(u*t.vote_usd-m*t.total_usd)/steem_price:0,n=$(document.createElement("tr")),o=$(document.createElement("td"));(v=$(document.createElement("a"))).attr("href","http://www.steemit.com/@"+t.name),v.attr("target","_blank");var c="@"+t.name;if((100==t.power&&t.last>4*HOURS||t.power<90)&&(c+=" (DOWN)"),v.html("<img class='userpic' src='https://steemitimages.com/u/"+t.name+"/avatar'></img>"+c),o.append(v),t.comments){var d=$('<span class="fa fa-comment-o ml5" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Allows Comments"></span>');o.append(d)}if(void 0!=t.posts_comment&&!t.posts_comment){d=$('<img src="img/no_comment.png" style="width: 20px; margin-left: 5px;" data-toggle="tooltip" data-placement="top" title="This bot does not post a comment when it votes on a post." />');o.append(d)}if(t.accepts_steem){d=$('<img src="img/steem.png" style="width: 20px; margin-left: 5px;" data-toggle="tooltip" data-placement="top" title="This bot accepts STEEM bids!" />');o.append(d)}if(t.refunds){d=$('<img src="img/refund.png" style="width: 20px; margin-left: 5px;" data-toggle="tooltip" data-placement="top" title="This bot automatically refunds invalid bids!" />');o.append(d)}if(t.funding_url){d=$('<a href="'+t.funding_url+'" target="_blank"><img src="img/funding.png" style="width: 20px; margin-left: 5px;" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="This bot uses a portion of its earnings to fund other projects and initiatives - Click for Details"/></a>');o.append(d)}n.append(o),(o=$(document.createElement("td"))).text(r(t)),n.append(o);var f="";t.accepts_steem&&(f=t.min_bid_steem&&t.min_bid_steem!=t.min_bid?" or "+t.min_bid_steem.formatMoney()+' <img src="img/steem.png" style="width: 17px; vertical-align: top;"/>':' or <img src="img/steem.png" style="width: 17px; vertical-align: top;"/>'),(o=$(document.createElement("td"))).html(t.min_bid.formatMoney()+" SBD"+f),n.append(o),(o=$(document.createElement("td"))).text(t.fill_limit?(100*(1-t.fill_limit)).toFixed()+"%":"none"),n.append(o),(o=$(document.createElement("td"))).text((t.min_post_age?t.min_post_age:0)+" mins / "+(t.max_post_age?t.max_post_age+" days":"unknown")),n.append(o),(o=$(document.createElement("td"))).text(isNaN(t.total_usd)?"--":function(t){switch(_){case"SBD":return(t.total_usd/sbd_price).formatMoney()+" SBD";case"STEEM":return(t.total_usd/steem_price).formatMoney()+" STEEM";case"USD":return"$"+t.total_usd.formatMoney();case"POST REWARDS":return"$"+(t.total_usd/t.vote_usd*t.vote).formatMoney()}}(t)),n.append(o),o=$(document.createElement("td")),isNaN(t.total_usd)?o.text("unknown"):t.accepts_steem?o.html(Math.max(a,0).formatMoney()+' <img src="img/steem.png" style="width: 17px; vertical-align: top;"/> or '+Math.max(e,0).formatMoney()+" SBD"):o.text(Math.max(e,0).formatMoney()+" SBD"),n.append(o),(o=$(document.createElement("td"))).addClass("timer"),o.attr("dir","up"),o.attr("time",t.last),o.text(toTimer(t.last)),n.append(o),(o=$(document.createElement("td"))).addClass("timer"),o.attr("time",t.next),o.text(toTimer(t.next)),n.append(o),o=$(document.createElement("td"));var g=$('<div class="dropdown"><button class="btn btn-xs btn-warning dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Actions&nbsp;<span class="caret"></span></button></div>'),h=$('<ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dLabel"></ul>');if(!isNaN(t.total_usd)){(v=$('<li><a href="javascript:void(0);"><i class="fa fa-eye mr5"></i>Details</a></li>')).click(function(e){!function(t){$("#bid_details_bot").text(t.name),console.log(t),$.get(t.api_url,function(e){var a=$("#bid_details_table_cur tbody");a.empty();var n=$("#bid_details_table_last tbody");n.empty(),e&&e.current_round&&(e.current_round.round_total=e.current_round.reduce(function(t,e){return t+getUsdValue(e)},0),s(a,t,e.current_round),$("#cur_round_vote").text(r(t)+" ("+t.interval/2.4*100+"%)"),$("#cur_round_bids").text(i(e.current_round,"SBD").formatMoney()+" SBD"+(t.accepts_steem?" & "+i(e.current_round,"STEEM").formatMoney()+" STEEM":"")),$("#cur_round_value").text("$"+t.total_usd.formatMoney()),$("#cur_round_roi").text((100*(t.vote_usd*u/e.current_round.round_total-1)).formatMoney()+"% (After Curation)")),e&&e.last_round&&(e.last_round.round_total=e.last_round.reduce(function(t,e){return t+getUsdValue(e)},0),s(n,t,e.last_round),$("#last_round_vote").text(r(t)+" ("+t.interval/2.4*100+"%)"),$("#last_round_bids").text(i(e.last_round,"SBD").formatMoney()+" SBD"+(t.accepts_steem?" & "+i(e.last_round,"STEEM").formatMoney()+" STEEM":"")),$("#last_round_value").text("$"+e.last_round.round_total.formatMoney()),$("#last_round_roi").text((100*(t.vote_usd*u/e.last_round.round_total-1)).formatMoney()+"% (After Curation)")),$("#cur_round_show").click(function(t){$("#cur_round").show(),$("#cur_round_show").parent().addClass("active"),$("#last_round").hide(),$("#last_round_show").parent().removeClass("active")}),$("#last_round_show").click(function(t){$("#cur_round").hide(),$("#cur_round_show").parent().removeClass("active"),$("#last_round").show(),$("#last_round_show").parent().addClass("active")})}),$("#bid_details").modal()}(t)}),h.append(v)}if((v=$('<li><a href="javascript:void(0);"><i class="fa fa-upload mr5"></i>Send Bid</a></li>')).click(function(e){l(t)}),h.append(v),t.rules_url&&""!=t.rules_url){var v=$('<li><a href="'+t.rules_url+'"><i class="fa fa-list-alt mr5"></i>Terms of Service</a></li>');h.append(v)}g.append(h),o.append(g),n.append(o),(e>0||a>0)&&t.next<.16*HOURS&&t.last>.5*HOURS?(n.addClass("green-bg"),t.notif||(!function(t,e){try{"granted"!==Notification.permission?Notification.requestPermission():new Notification("Profitable Bidding Opportunity!",{icon:"https://i.imgur.com/SEm0LBl.jpg",body:"@"+t+" is currently showing a profitable bidding opportunity! Max profitable bid is $"+e.formatMoney()+" SBD."})}catch(t){}}(t.name,e),t.notif=!0)):t.notif=!1,(100==t.power&&t.last>4*HOURS||t.power<90)&&n.addClass("red-light-bg"),$("#bots_table tbody").append(n),$('[data-toggle="tooltip"]').tooltip()}})}function r(t){switch(_){case"SBD":return(t.vote_usd/sbd_price).formatMoney()+" SBD";case"STEEM":return(t.vote_usd/steem_price).formatMoney()+" STEEM";case"USD":return"$"+t.vote_usd.formatMoney();case"POST REWARDS":return"$"+t.vote.formatMoney()}}function i(t,e){return t.reduce(function(t,a){return t+(a.currency==e?parseFloat(a.amount):0)},0)}function s(t,e,a){a.forEach(function(n){var o=parseFloat(n.amount),i=getUsdValue(n),s=n.currency,l=$(document.createElement("tr")),c=$(document.createElement("td"));(u=$(document.createElement("a"))).attr("href","http://www.steemit.com/@"+n.sender),u.attr("target","_blank"),u.text("@"+n.sender),c.append(u),l.append(c);(c=$(document.createElement("td"))).text(o.formatMoney()+" "+s),c.css("text-align","right"),l.append(c);(c=$(document.createElement("td"))).text("$"+i.formatMoney()),c.css("text-align","right"),l.append(c);(c=$(document.createElement("td"))).text((n.weight?(n.weight/100).formatMoney():(i/a.round_total*100).formatMoney())+"%"),c.css("text-align","right"),l.append(c);var d=((n.weight?n.weight/1e4:i/a.round_total)*parseFloat(r(e).replace(/[$,]/g,""))).formatMoney();d="SBD"==_||"STEEM"==_?d+" "+_:"$"+d;(c=$(document.createElement("td"))).text(d),c.css("text-align","right"),l.append(c);c=$(document.createElement("td"));var m=$(document.createElement("div"));m.css("width","250px"),m.css("overflow","hidden"),m.css("height","23px");var u;(u=$(document.createElement("a"))).attr("href","https://steemit.com"+n.url),u.attr("target","_blank"),u.text(n.url),m.append(u),c.append(m),l.append(c),t.append(l)})}function l(t){$("#bid_details_dialog_bot_name").text(t.name),$("#bid_details_error").hide(),$("#bid_details_btn_submit").click(c),$("#bid_details_post_url").val(""),$("#bid_details_bid_amount").val(t.min_bid),$("#bid_details_bid_amount").attr("min",t.min_bid),(w=$("#bid_details_dialog").modal()).off("hidden.bs.modal"),w.bot=t;var e=E?E.name:localStorage.getItem("bid_details_account_name");e&&($("#bid_details_account_name").val(e),d())}function c(){var t=$("#bid_details_dialog_bot_name").text(),e=$("#bid_details_account_name").val(),a=$("#bid_details_bid_amount").val(),n=$("#bid_details_bid_currency").val(),o=$("#bid_details_post_url").val();!function(t,e,a,n,o){{if("STEEM"==n&&!t.accepts_steem)return void o("This bot does not accept STEEM bids!");if("STEEM"==n&&parseFloat(a)<t.min_bid_steem)return void o("Bid is below the minimum, please bid "+t.min_bid_steem+" STEEM or more!");if("SBD"==n&&parseFloat(a)<t.min_bid)return void o("Bid is below the minimum, please bid "+t.min_bid+" SBD or more!")}var r=e.substr(e.lastIndexOf("/")+1),i=e.substring(e.lastIndexOf("@")+1,e.lastIndexOf("/"));steem.api.getContent(i,r,function(e,a){if(!e&&a&&a.id>0){var n=new Date(a.created+"Z"),r=a.active_votes.filter(function(e){return e.voter==t.name}),i=r.length>0&&new Date-new Date(r[0].time+"Z")>12e5;i?o("This bot has already voted on this post!"):new Date-n>=24*t.max_post_age*60*60*1e3?o("This post is past the max age accepted by this bot!"):o(null)}else o("There was an error loading this post, please check the URL.")})}(w.bot,o,a,n,function(r){r?($("#bid_details_error").html("<b>Error:</b> "+r),$("#bid_details_error").show()):(w.on("hidden.bs.modal",function(r){$("#bid_dialog_bot_name").text(t),$("#bid_dialog_frame").attr("src","https://v2.steemconnect.com/sign/transfer?from="+e+"&to="+t+"&amount="+a+" "+n+"&memo="+o),w=$("#bid_dialog").modal()}),w.modal("hide"))})}function d(){var t=$("#bid_details_account_name").val(),e=$("#bid_details_recent_posts"),a=(new Date).getTime()-24*(w.bot.max_post_age?w.bot.max_post_age:6)*60*60*1e3;steem.api.getDiscussionsByAuthorBeforeDate(t,null,(new Date).toISOString().split(".")[0],5,function(t,n){var o=n.filter(function(t){return new Date(t.created).getTime()>a});o.length>0?e.empty():e.html("None Found"),o.forEach(function(t){var a=t.title.length>25?t.title.substring(0,22)+"...":t.title,n=$('<button type="button" class="btn btn-info btn-xs" style="margin: 0 5px;">'+a+"</button>");e.append(n),n.click(function(){$("#bid_details_post_url").val("https://steemit.com"+t.url)})})})}var m=1,u=.75,p=20,_="USD",f=[],g=[],h=18e5,v="https://steembottracker.net",b={},E=null,w=null;!function(){try{Notification&&"granted"!==Notification.permission&&Notification.requestPermission()}catch(t){}t(),setInterval(t,3e4),e(),setInterval(e,6e5),a(),setInterval(a,3e4),updateSteemVariables(n),setInterval(n,6e5),setInterval(updateTimers,1e3),function(){function t(t){b[t]=!b[t],$("#filter_"+t).css("border",b[t]?"2px solid green":"none"),o()}$("#curation_option").on("change",function(){u=this.checked?.75:1,o()}),localStorage.hasOwnProperty("currency_list")?($("#currency_list").val(localStorage.getItem("currency_list")),_=localStorage.getItem("currency_list")):localStorage.setItem("currency_list","USD"),$("#currency_list").change(function(){_=$("#currency_list").val(),localStorage.setItem("currency_list",_),o()}),$("#min_vote_slider").slider(),$("#bid_details_account_name").on("change",function(t){localStorage.setItem("bid_details_account_name",$("#bid_details_account_name").val()),d()}),localStorage.hasOwnProperty("min_vote_slider")?($("#min_vote_slider").slider("setValue",localStorage.getItem("min_vote_slider")),p=parseFloat(localStorage.getItem("min_vote_slider"))):localStorage.setItem("min_vote_slider",p),$("#min_vote_slider").on("slide",function(t){t.value!=p&&(p=parseFloat(t.value),localStorage.setItem("min_vote_slider",t.value),o())}),$("#calculate_vote").click(function(){var t=null,e=$("#bot_list").val();f.forEach(function(a){a.name!=e||(t=a)});var a=$("#calc_currency").val(),n=parseFloat($("#bid_amount").val()),o="SBD"==a?n*sbd_price:n*steem_price,r=o/(o+t.total_usd)*t.vote_usd,i=o/(o+t.total_usd)*t.vote/2,s=o/(o+t.total_usd)*t.vote/2/steem_price;return $("#bid_value").text("$"+o.formatMoney()),$("#vote_value").text("$"+r.formatMoney()+" = "+i.formatMoney()+" SBD + "+s.formatMoney()+" STEEM"),$("#vote_value_net").text("$"+(.75*r).formatMoney()+" = "+(.75*i).formatMoney()+" SBD + "+(.75*s).formatMoney()+" STEEM"),$("#vote_value").css("color",r>=o?"#008800":"#FF0000"),$("#vote_value_net").css("color",.75*r>=o?"#008800":"#FF0000"),!1}),setTimeout(function(){$("#disclaimer").modal()},2e3),$("#filter_verified").click(function(){t("verified")}),$("#filter_refund").click(function(){t("refund")}),$("#filter_steem").click(function(){t("steem")}),$("#filter_funding").click(function(){t("funding")}),$("#filter_nocomment").click(function(){t("nocomment")}),$("#minnowbooster-submit").click(function(){l({name:"minnowbooster",min_bid:.01,max_post_age:6.3})}),$("#randowhale-submit").click(function(){l({name:"randowhale",min_bid:1,max_post_age:3.5})}),$("#smartsteem-submit").click(function(){l({name:"smartmarket",min_bid:.1,max_post_age:6.3})});var e=getURLParameter("access_token")?getURLParameter("access_token"):localStorage.getItem("access_token");sc2.init({baseURL:"https://v2.steemconnect.com",app:"bottracker.app",accessToken:e,callbackURL:"https://steembottracker.com",scope:["login","vote"]}),sc2.me(function(t,a){a&&!t?(console.log(a),E=a.account,$("#btn_login").hide(),$("#user_info").show(),$("#login_info").text("@"+E.name),localStorage.setItem("access_token",e)):($("#btn_login").show(),$("#user_info").hide())}),$("#btn_logout").click(function(){localStorage.removeItem("access_token"),window.location.href=window.location.pathname}),$("#btn_bid_history").click(function(){$("#user_bids").modal(),steem.api.getAccountHistory(E.name,-1,1e3,function(t,e){for(var a=[],n=0,o=0;o<e.length;o++){var r=e[o],i=r[1].op,s=i[1];if("transfer"==i[0]&&g.indexOf(s.to)>=0){if(!checkMemo(s.memo))continue;a.push(s),function(t,e){var a=t.memo.substr(t.memo.lastIndexOf("/")+1),n=t.memo.substring(t.memo.lastIndexOf("@")+1,t.memo.lastIndexOf("/"));steem.api.getContent(n,a,function(a,n){if(!a&&n&&n.id>0){var o=n.active_votes.find(function(e){return e.voter==t.to});o&&(t.vote_rshares=o.rshares,t.vote_percent=o.percent),t.title=n.title}else console.log(a);e&&e()})}(s,function(){++n>=a.length&&(console.log(a),function(t){var e=$("#user_bids_table tbody");e.empty(),$("#user_bids_name").text(E.name),t.reverse(),t.forEach(function(t){if(t.title){var a=parseFloat(t.amount),n=getUsdValue(t),o=getCurrency(t.amount),r=$(document.createElement("tr")),i=$(document.createElement("td")),s=$(document.createElement("a"));s.attr("href",t.memo),s.attr("target","_blank"),s.text(t.title.length>30?t.title.substr(0,30)+"...":t.title),i.append(s),r.append(i);var i=$(document.createElement("td")),s=$(document.createElement("a"));s.attr("href","https://steemit.com/@"+t.to),s.attr("target","_blank"),s.text("@"+t.to),i.append(s),r.append(i);var i=$(document.createElement("td"));i.text(a.formatMoney()+" "+o+(t.refunded?" (refunded)":"")),i.css("text-align","right"),r.append(i);var i=$(document.createElement("td"));i.text("$"+n.formatMoney()),i.css("text-align","right"),r.append(i);var i=$(document.createElement("td"));i.text(t.refunded||!t.vote_rshares?"--":(t.vote_percent/100).formatMoney()+"%"),i.css("text-align","right"),r.append(i);var l=t.vote_rshares*rewardBalance/recentClaims*steemPrice,i=$(document.createElement("td"));i.text(t.refunded||!t.vote_rshares?"--":"$"+l.formatMoney()),i.css("text-align","right"),r.append(i);var i=$(document.createElement("td"));i.text(t.refunded||!t.vote_rshares?"--":"$"+(l/2*sbd_price+l/2).formatMoney()),i.css("text-align","right"),r.append(i);var i=$(document.createElement("td"));i.text(t.refunded||!t.vote_rshares?"--":(100*((l/2*sbd_price+l/2)/n-1)).formatMoney()+"%"),i.css("text-align","right"),r.append(i),e.append(r)}})}(a))})}else if("transfer"==i[0]&&g.indexOf(i[1].from)>=0){var s=a.find(function(t){return t.to==i[1].from&&t.amount==i[1].amount});s&&(s.refunded=!0)}}})}),$("#btn_front_run").click(function(){$.get(v+"/posts",function(t){var e=t,a=0;e.forEach(function(t){var n=t.permlink,o=t.author;steem.api.getContent(o,n,function(n,o){if(!n&&o&&o.id>0){t.created=new Date(o.created+"Z"),t.payout=parseFloat(o.pending_payout_value),t.title=o.title,t.author=o.author,t.permlink=o.permlink;var r=Math.min(new Date-new Date(o.created+"Z"),h)/h;t.curation_reward=(Math.sqrt(.25*(t.payout+1))-Math.sqrt(.25*t.payout))*Math.sqrt(.25*(t.payout+1+t.vote_value))*r,E&&(t.voted=null!=o.active_votes.find(function(t){return t.voter==E.name}))}++a>=e.length&&(e.sort(function(t,e){return parseFloat(e.curation_reward)-parseFloat(t.curation_reward)}),function(t){var e=$("#front_runner_table tbody");e.empty(),t.forEach(function(t){if(t.title){var a=$(document.createElement("tr")),n=$(document.createElement("td")),o=$(document.createElement("a"));o.attr("href","https://steemit.com/@"+t.author),o.attr("target","_blank"),o.text("@"+t.author),n.append(o),a.append(n);var n=$(document.createElement("td")),o=$(document.createElement("a"));o.attr("href","https://steemit.com"+t.url),o.attr("target","_blank"),o.text(t.title.length>40?t.title.substr(0,40)+"...":t.title),n.append(o),a.append(n);var n=$(document.createElement("td"));n.text("$"+t.payout.formatMoney()),n.css("text-align","right"),a.append(n);var n=$(document.createElement("td"));n.text("$"+parseFloat(t.amount).formatMoney()),n.css("text-align","right"),a.append(n);var n=$(document.createElement("td"));n.text("$"+t.vote_value.formatMoney()),n.css("text-align","right"),a.append(n);var n=$(document.createElement("td"));if(n.text("$"+t.curation_reward.formatMoney()+" / $1"),n.css("text-align","right"),a.append(n),n=$(document.createElement("td")),t.voted)n.text("Voted");else{var o=$('<button type="button" class="btn btn-info btn-xs"><i class="fa fa-thumbs-up mr5"></i>Upvote</button>');o.click(function(e){E?(n.empty(),n.text("Voting..."),sc2.vote(E.name,t.author,t.permlink,1e4,function(t,e){console.log(t,e),e&&!t?n.text("Success!"):(n.empty(),n.append(o))})):window.location.href=sc2.getLoginURL()}),n.append(o)}n.css("text-align","center"),a.append(n),e.append(a)}})}(e))})})}),$("#front_runner_dialog").modal()})}()}()});